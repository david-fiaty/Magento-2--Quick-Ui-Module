/**
 * Naxero.com
 * Professional ecommerce integrations for Magento
 *
 * PHP version 7
 *
 * @category  Magento2
 * @package   Naxero
 * @author    Platforms Development Team <contact@naxero.com>
 * @copyright Naxero.com
 * @license   https://opensource.org/licenses/mit-license.html MIT License
 * @link      https://www.naxero.com
 */

define(["jquery","Magento_Ui/js/modal/prompt","Naxero_Translation/js/translation/core","mage/url","mage/translate","jquery/ui"],function(t,e,n,o,a){"use strict";return{importData:function(o){var i={block_type:"prompt",template_name:"import-data",form_key:window.FORM_KEY};t.ajax({type:"POST",url:o.options.promptUrl,showLoader:!0,data:i,success:function(i){e({title:a("Import translation data"),content:i.html,actions:{confirm:function(){var e=t("#new_file_import")[0].files[0];n.importFile(o,e,o.detailViewId)},cancel:function(){},always:function(){}},opened:function(){t("button.action-accept").prop("disabled",!0)}}),t("#new_file_import").on("change",function(){0==t(this).val().replace(" ","").length?t("button.action-accept").prop("disabled",!0):t("button.action-accept").prop("disabled",!1)})},error:function(t,e,n){console.log(n)}})},newFile:function(o){var i=this,c={block_type:"prompt",template_name:"new-file",form_key:window.FORM_KEY};t.ajax({type:"POST",url:o.options.promptUrl,showLoader:!0,data:c,success:function(c){e({title:a("New translation file"),content:c.html,actions:{confirm:function(){n.createFile(o,{file_path:t("#new_file_path").val(),file_name:t("#new_file_name").val()})},cancel:function(){},always:function(){}},opened:function(){t("button.action-accept").prop("disabled",!0)}});var l=[],r=[];o.cache._(o.options.targetTable).tabulator("getRows").forEach(function(t){var e=t.getData().file_path,n=e.split("/"),o=n[n.length-1],a=e.replace(o,"");-1==l.indexOf(a)&&l.push(a),-1==r.indexOf(o)&&r.push(o)}),i.initAutocompleteFields([{id:"new_file_path",source:l},{id:"new_file_name",source:r}])},error:function(t,e,n){console.log(n)}})},initAutocompleteFields:function(e){e.forEach(function(e){t("#"+e.id).autocomplete({source:e.source,open:function(e,n){t(this).autocomplete("widget").css({width:t(this).width()+"px"})}}),t("#"+e.id).on("input",function(){var e=0;t('input[name^="new_file_"]').each(function(n){0===t(this).val().replace(" ","").length&&e++}),0==e?t("button.action-accept").prop("disabled",!1):t("button.action-accept").prop("disabled",!0)})})},newScan:function(o){var i={block_type:"prompt",template_name:"scan-files",form_key:window.FORM_KEY};t.ajax({type:"POST",url:o.options.promptUrl,showLoader:!0,data:i,success:function(t){e({title:a("Scan files"),content:t.html,actions:{confirm:function(){var t=o.cache._("input[name=update_mode]:checked").val();n.updateFileIndex(o,t)},cancel:function(){},always:function(){}}})},error:function(t,e,n){console.log(n)}})}}});